# Orchestra Dialect & IR Definition

This directory contains the header files (`.h`) and TableGen definition files (`.td`) that collectively define the Orchestra dialect, its operations, types, and interfaces. These files serve as the canonical, machine-readable specification for the core Intermediate Representation (IR) of the Orchestra compiler.

## Key Files

*   **`OrchestraDialect.h` / `.td`**: Defines the `Orchestra` dialect itself. This is the main entry point for registering the dialect with the MLIR context.
*   **`OrchestraOps.h` / `.td`**: Defines the custom operations of the `Orchestra` dialect (e.g., `orchestra.task`, `orchestra.commit`). The `.td` file specifies the arguments, results, and other properties of the ops, while the `.h` file provides the C++ class declarations.
*   **`OrchestraInterfaces.h` / `.td`**: Defines any dialect-specific interfaces.
*   **`Passes.h`**: Declares the factory functions for creating instances of the Orchestra transformation passes (e.g., `createLowerOrchestraToGPUPass`). Note that the *declaration* is here, but the *implementation* is in the `lib/` directory.

## Common Pitfalls & Hot Tips

### Understanding TableGen (`.td` files)

The `.td` files are not C++ code. They are written in [TableGen](https://mlir.llvm.org/docs/TableGen/), a record-keeping language used by LLVM and MLIR to generate boilerplate C++ code. When you modify a `.td` file (e.g., to add a new operation), you are not directly changing the compiler's code. Instead, you are changing the specification from which the C++ code will be generated during the build process.

### The Role of `.inc` Files

You will see lines like `#include "Orchestra/OrchestraOps.h.inc"` in the header files. These `.inc` files **do not exist in the source tree**. They are generated by the build system (CMake/Ninja) from the `.td` files. If your IDE shows an error that it cannot find an `.inc` file, this is expected. The code will still compile correctly as long as you have configured the build with CMake. This is a very common point of confusion for developers new to the MLIR codebase.
